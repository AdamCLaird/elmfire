!> test_half_superbee.f90
!! Unit test for function HALF_SUPERBEE(R) in elmfire_level_set.f90
!! Updated: 2025-07-21

PROGRAM TEST_HALF_SUPERBEE
  IMPLICIT NONE
  REAL :: RESULT, EXPECTED
  INTEGER :: NFAIL

  INTERFACE
    REAL FUNCTION HALF_SUPERBEE(R)
      REAL, INTENT(IN) :: R
    END FUNCTION HALF_SUPERBEE
  END INTERFACE

  PRINT *, 'TESTING HALF_SUPERBEE...'
  NFAIL = 0

  CALL CHECK(-1.0, 0.0)
  CALL CHECK( 0.0, 0.0)
  CALL CHECK( 0.5, 0.25)
  CALL CHECK( 1.0, 0.5)
  CALL CHECK( 1.5, 0.75)
  CALL CHECK( 2.0, 1.0)
  CALL CHECK( 3.0, 1.0)

  IF (NFAIL == 0) THEN
     PRINT *, 'PASS: ALL TESTS PASSED.'
  ELSE
     PRINT *, 'FAIL: ', NFAIL, ' TEST(S) FAILED.'
     STOP 1
  END IF

CONTAINS

  SUBROUTINE CHECK(R, EXPECTED)
    REAL, INTENT(IN) :: R, EXPECTED
    REAL :: RESULT
    RESULT = HALF_SUPERBEE(R)
    IF (ABS(RESULT - EXPECTED) > 1.0E-6) THEN
      PRINT *, 'FAIL: R=', R, ' EXPECTED=', EXPECTED, ' GOT=', RESULT
      NFAIL = NFAIL + 1
    END IF
  END SUBROUTINE

END PROGRAM